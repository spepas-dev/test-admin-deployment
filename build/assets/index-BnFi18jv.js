import{r as x,j as e,i as w,a as f,W as R,U as V,b as D,m as N}from"./index-DerKfh_i.js";import{C as B,a as J}from"./card-B6ouLRYl.js";import{u as O,s as H,o as T,a as W,F as q,b,c as v,d as C,e as A,f as S,g as G,h as E,n as k}from"./form-BqdHsX1y.js";import{u as I,G as _,M as F,I as K}from"./esm-DZ7ib8zA.js";import{D as Q,b as X,d as Y,e as Z,f as L,T as ee,g as P,h as se,i as ae,j as M,k as y,l as re,m as j}from"./table-C4EX-m7M.js";import{I as U}from"./input-D3bTOU5h.js";import{M as le}from"./multi-select-D1bUAzzq.js";import{M as $}from"./map-pin-PjRSADGH.js";import"./badge-C6fu0KNW.js";import"./index-BnZGiQrK.js";import"./wand-sparkles-DhWsRIAQ.js";const te=T({shop_name:E().min(1,"Shop name is required"),longitude:k(),latitude:k(),address:E().min(1,"Address is required"),User_ID:E().min(1,"Please select a user")}),ne=T({mechanics:G(te).min(1,"Add at least one mechanic shop")}),ie=[{value:"user1",label:"John Doe",icon:w},{value:"user2",label:"Jane Smith",icon:w}],ce=["places"];function oe({open:i,onOpenChange:c,onSubmit:a,selectedLocation:s}){const{isLoaded:m,loadError:o}=I({googleMapsApiKey:"",libraries:ce}),l=x.useMemo(()=>({lat:5.6037,lng:-.187}),[]),r=O({resolver:H(ne),defaultValues:{mechanics:[{shop_name:"",longitude:(s==null?void 0:s.lng)||l.lng,latitude:(s==null?void 0:s.lat)||l.lat,address:"",User_ID:""}]}}),{fields:n,append:p,remove:t}=W({control:r.control,name:"mechanics"});x.useEffect(()=>{i||r.reset({mechanics:[{shop_name:"",longitude:(s==null?void 0:s.lng)||l.lng,latitude:(s==null?void 0:s.lat)||l.lat,address:"",User_ID:""}]})},[i,s,l]);const h=u=>{a(u.mechanics),r.reset()};return o?e.jsx("div",{children:"Error loading map. Please check your API key."}):m?e.jsx(Q,{open:i,onOpenChange:c,children:e.jsxs(X,{className:"max-w-2xl bg-white",children:[e.jsxs(Y,{children:[e.jsx(Z,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Mechanic Shop"}),e.jsx(L,{className:"text-gray-600",children:"Register new mechanic shops and their locations"})]}),e.jsx(q,{...r,children:e.jsxs("form",{onSubmit:r.handleSubmit(h),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:n.map((u,g)=>e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx(b,{control:r.control,name:`mechanics.${g}.User_ID`,render:({field:d})=>e.jsxs(v,{children:[e.jsx(C,{className:"text-gray-700",children:"Select Mechanic"}),e.jsx(A,{children:e.jsx(le,{options:ie,value:[d.value],onValueChange:z=>d.onChange(z[0]),placeholder:"Select a mechanic",maxCount:1,variant:"default"})}),e.jsx(S,{className:"text-red-500"})]})}),e.jsx(b,{control:r.control,name:`mechanics.${g}.shop_name`,render:({field:d})=>e.jsxs(v,{children:[e.jsx(C,{className:"text-gray-700",children:"Shop Name"}),e.jsx(A,{children:e.jsx(U,{placeholder:"Enter shop name",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...d})}),e.jsx(S,{className:"text-red-500"})]})}),e.jsx(b,{control:r.control,name:`mechanics.${g}.address`,render:({field:d})=>e.jsxs(v,{children:[e.jsx(C,{className:"text-gray-700",children:"Address"}),e.jsx(A,{children:e.jsx(U,{placeholder:"Enter shop address",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...d})}),e.jsx(S,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(_,{zoom:13,center:l,mapContainerClassName:"w-full h-full",onClick:d=>{d.latLng&&(r.setValue(`mechanics.${g}.latitude`,d.latLng.lat()),r.setValue(`mechanics.${g}.longitude`,d.latLng.lng()))},children:e.jsx(F,{position:{lat:u.latitude,lng:u.longitude}})})}),n.length>1&&e.jsx(f,{type:"button",variant:"outline",size:"icon",className:"hover:bg-gray-100",onClick:()=>t(g),children:e.jsx(ee,{className:"w-4 h-4 text-gray-600"})})]},u.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(f,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>p({shop_name:"",longitude:l.lng,latitude:l.lat,address:"",User_ID:""}),children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(f,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Shops"})]})]})})]})}):e.jsx("div",{children:"Loading..."})}const de=["places"];function me({mechanics:i,selectedLocation:c,onLocationSelect:a}){const{isLoaded:s,loadError:m}=I({googleMapsApiKey:"",libraries:de}),[o,l]=x.useState(null),r=x.useMemo(()=>c||{lat:5.6037,lng:-.187},[c]);return m?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-red-600",children:"Error loading map. Please check your API key."})}):s?e.jsxs(_,{zoom:13,center:r,mapContainerClassName:"w-full h-full",onClick:n=>{n.latLng&&a({lat:n.latLng.lat(),lng:n.latLng.lng()})},children:[i.map((n,p)=>e.jsx(F,{position:{lat:n.latitude,lng:n.longitude},onClick:()=>l(n)},p)),o&&e.jsx(K,{position:{lat:o.latitude,lng:o.longitude},onCloseClick:()=>l(null),children:e.jsxs("div",{className:"p-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:o.shop_name}),e.jsx("p",{className:"text-sm text-gray-600",children:o.address})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-gray-600",children:"Loading map..."})})}const he={user1:{name:"John Doe",email:"john@example.com"},user2:{name:"Jane Smith",email:"jane@example.com"}};function xe({mechanics:i,onLocationSelect:c}){return e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsxs(se,{children:[e.jsx(ae,{children:e.jsxs(M,{className:"bg-gray-50",children:[e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Shop Name"}),e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Owner"}),e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Address"}),e.jsx(y,{className:"text-[#4A36EC] font-semibold",children:"Location"})]})}),e.jsxs(re,{children:[i.map((a,s)=>{var m;return e.jsxs(M,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(j,{className:"text-gray-700 font-medium",children:a.shop_name}),e.jsx(j,{className:"text-gray-700",children:((m=he[a.User_ID])==null?void 0:m.name)||"Unknown User"}),e.jsx(j,{className:"text-gray-700",children:a.address}),e.jsx(j,{children:e.jsxs(f,{variant:"outline",size:"sm",className:"hover:bg-[#4A36EC]/10",onClick:()=>c({lat:a.latitude,lng:a.longitude}),children:[e.jsx($,{className:"w-4 h-4 mr-2 text-[#4A36EC]"}),"View on Map"]})})]},s)}),i.length===0&&e.jsx(M,{children:e.jsx(j,{colSpan:4,className:"text-center text-gray-500 py-8",children:"No mechanic shops added yet"})})]})]})})}function Se(){const[i,c]=x.useState(!1),[a,s]=x.useState([]),[m,o]=x.useState(null),[l,r]=x.useState(null),n=async t=>{try{console.log(t),s([...a,...t]),c(!1),r(null)}catch(h){r("Failed to add mechanics"),console.error(h)}},p=[{title:"Total Mechanics",value:a.length,icon:R,description:"Registered mechanic shops",trend:"+2.5%",trendUp:!0},{title:"Active Locations",value:a.length,icon:$,description:"Service locations",trend:"+1.8%",trendUp:!0},{title:"Shop Types",value:"12",icon:w,description:"Different specializations",trend:"+3.2%",trendUp:!0},{title:"Service Areas",value:new Set(a.map(t=>{var h;return(h=t.address.split(",").pop())==null?void 0:h.trim()})).size,icon:V,description:"Areas covered",trend:"+0.9%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(D,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/user-management",className:"hover:text-[#4A36EC]",children:"User Management"}),e.jsx(D,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Mechanics"})]}),e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Mechanic Shops"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage mechanic shops and their locations"})]}),e.jsxs(f,{onClick:()=>c(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(P,{className:"w-4 h-4 mr-2"}),"Add Mechanic Shop"]})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:p.map((t,h)=>e.jsx(B,{className:"border border-gray-200 hover:border-[#4A36EC] transition-colors",children:e.jsxs(J,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t.title}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.value})]}),e.jsx("div",{className:"bg-[#4A36EC]/10 p-2 rounded-lg",children:e.jsx(t.icon,{className:"w-5 h-5 text-[#4A36EC]"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:t.description}),e.jsx("span",{className:`text-xs font-medium ${t.trendUp?"text-green-600":"text-red-600"}`,children:t.trend})]})]})},h))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-6",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"lg:col-span-2 h-[400px] rounded-lg overflow-hidden border",children:e.jsx(me,{mechanics:a,selectedLocation:m,onLocationSelect:o})}),e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"lg:col-span-4",children:e.jsx(xe,{mechanics:a,onLocationSelect:o})})]}),l&&e.jsx("div",{className:"text-red-600 text-sm",children:l}),e.jsx(oe,{open:i,onOpenChange:c,onSubmit:n,selectedLocation:m})]})}export{Se as default};
