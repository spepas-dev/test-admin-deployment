import{r as x,j as e,B as v,a as b,U as _,b as C,m as N}from"./index-DerKfh_i.js";import{C as z,a as P}from"./card-B6ouLRYl.js";import{u as V,s as J,o as U,a as G,F as H,b as A,c as E,d as w,e as S,f as D,g as L,h as R,n as M}from"./form-BqdHsX1y.js";import{u as I,G as k,M as T,I as O}from"./esm-DZ7ib8zA.js";import{D as K,b as X,d as Y,e as q,f as W,T as Z,g as F,h as Q,i as ee,j as y,k as f,l as se,m as p}from"./table-C4EX-m7M.js";import{I as ae}from"./input-D3bTOU5h.js";import{M as re}from"./multi-select-D1bUAzzq.js";import{B as le}from"./badge-C6fu0KNW.js";import{M as $}from"./map-pin-PjRSADGH.js";import{I as te}from"./id-card-DquTI-Vn.js";import"./index-BnZGiQrK.js";import"./wand-sparkles-DhWsRIAQ.js";const ie=U({licenseNumber:R().min(1,"License number is required").regex(/^[A-Z]{2}-\d{6}-\d{2}$/,"License number format should be XX-123456-YY"),longitude:M(),latitude:M(),User_ID:R().min(1,"Please select a user")}),ne=U({riders:L(ie).min(1,"Add at least one rider")}),de=[{value:"8c66228b-9527-490b-a174-b15cb557100b",label:"John Rider",icon:v},{value:"9c66228b-9527-490b-a174-b15cb557100c",label:"Jane Rider",icon:v}],oe=["places"];function ce({open:n,onOpenChange:d,onSubmit:a,selectedLocation:s}){const{isLoaded:c,loadError:o}=I({googleMapsApiKey:"",libraries:oe}),r=x.useMemo(()=>({lat:5.6037,lng:-.187}),[]),l=V({resolver:J(ne),defaultValues:{riders:[{licenseNumber:"",longitude:(s==null?void 0:s.lng)||r.lng,latitude:(s==null?void 0:s.lat)||r.lat,User_ID:""}]}}),{fields:i,append:h,remove:t}=G({control:l.control,name:"riders"});x.useEffect(()=>{n||l.reset({riders:[{licenseNumber:"",longitude:(s==null?void 0:s.lng)||r.lng,latitude:(s==null?void 0:s.lat)||r.lat,User_ID:""}]})},[n,s,r]);const u=g=>{a(g.riders),l.reset()};return o?e.jsx("div",{children:"Error loading map"}):c?e.jsx(K,{open:n,onOpenChange:d,children:e.jsxs(X,{className:"max-w-2xl bg-white",children:[e.jsxs(Y,{children:[e.jsx(q,{className:"text-[#4A36EC] text-xl font-bold",children:"Add Rider"}),e.jsx(W,{className:"text-gray-600",children:"Register new delivery riders and their locations"})]}),e.jsx(H,{...l,children:e.jsxs("form",{onSubmit:l.handleSubmit(u),className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:i.map((g,j)=>e.jsxs("div",{className:"space-y-4 p-4 border rounded-lg",children:[e.jsx(A,{control:l.control,name:`riders.${j}.User_ID`,render:({field:m})=>e.jsxs(E,{children:[e.jsx(w,{className:"text-gray-700",children:"Select User"}),e.jsx(S,{children:e.jsx(re,{options:de,value:[m.value],onValueChange:B=>m.onChange(B[0]),placeholder:"Select a user",maxCount:1})}),e.jsx(D,{className:"text-red-500"})]})}),e.jsx(A,{control:l.control,name:`riders.${j}.licenseNumber`,render:({field:m})=>e.jsxs(E,{children:[e.jsx(w,{className:"text-gray-700",children:"License Number"}),e.jsx(S,{children:e.jsx(ae,{placeholder:"GA-123456-24",className:"border-gray-200 focus:border-[#4A36EC] focus:ring-[#4A36EC]",...m})}),e.jsx(D,{className:"text-red-500"})]})}),e.jsx("div",{className:"h-[200px] rounded-lg overflow-hidden",children:e.jsx(k,{zoom:13,center:r,mapContainerClassName:"w-full h-full",onClick:m=>{m.latLng&&(l.setValue(`riders.${j}.latitude`,m.latLng.lat()),l.setValue(`riders.${j}.longitude`,m.latLng.lng()))},children:e.jsx(T,{position:{lat:g.latitude,lng:g.longitude}})})}),i.length>1&&e.jsx(b,{type:"button",variant:"outline",size:"icon",className:"hover:bg-gray-100",onClick:()=>t(j),children:e.jsx(Z,{className:"w-4 h-4 text-gray-600"})})]},g.id))}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs(b,{type:"button",variant:"outline",className:"hover:bg-gray-100",onClick:()=>h({licenseNumber:"",longitude:r.lng,latitude:r.lat,User_ID:""}),children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Add Another"]}),e.jsx(b,{type:"submit",className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:"Save Riders"})]})]})})]})}):e.jsx("div",{children:"Loading..."})}const me=["places"];function xe({riders:n,selectedLocation:d,onLocationSelect:a}){const{isLoaded:s,loadError:c}=I({googleMapsApiKey:"",libraries:me}),[o,r]=x.useState(null),l=x.useMemo(()=>d||{lat:5.6037,lng:-.187},[d]);return c?e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-red-600",children:"Error loading map. Please check your API key."})}):s?e.jsxs(k,{zoom:13,center:l,mapContainerClassName:"w-full h-full",onClick:i=>{i.latLng&&a({lat:i.latLng.lat(),lng:i.latLng.lng()})},children:[n.map((i,h)=>e.jsx(T,{position:{lat:i.latitude,lng:i.longitude},onClick:()=>r(i)},h)),o&&e.jsx(O,{position:{lat:o.latitude,lng:o.longitude},onCloseClick:()=>r(null),children:e.jsxs("div",{className:"p-2",children:[e.jsxs("h3",{className:"font-medium text-gray-900",children:["License: ",o.licenseNumber]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["ID: ",o.User_ID]})]})})]}):e.jsx("div",{className:"h-full flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"text-gray-600",children:"Loading map..."})})}const he={"8c66228b-9527-490b-a174-b15cb557100b":{name:"John Rider",email:"john@example.com"},"9c66228b-9527-490b-a174-b15cb557100c":{name:"Jane Rider",email:"jane@example.com"}};function ue({riders:n,onLocationSelect:d}){return e.jsx("div",{className:"border rounded-lg bg-white",children:e.jsxs(Q,{children:[e.jsx(ee,{children:e.jsxs(y,{className:"bg-gray-50",children:[e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"License Number"}),e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"Rider Name"}),e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"Location"}),e.jsx(f,{className:"text-[#4A36EC] font-semibold",children:"Actions"})]})}),e.jsxs(se,{children:[n.map((a,s)=>{var c;return e.jsxs(y,{className:"hover:bg-gray-50 transition-colors",children:[e.jsx(p,{className:"text-gray-700 font-medium",children:a.licenseNumber}),e.jsx(p,{className:"text-gray-700",children:((c=he[a.User_ID])==null?void 0:c.name)||"Unknown User"}),e.jsx(p,{className:"text-gray-700",children:e.jsx(le,{variant:"secondary",children:`${a.latitude.toFixed(4)}, ${a.longitude.toFixed(4)}`})}),e.jsx(p,{children:e.jsxs(b,{variant:"outline",size:"sm",className:"hover:bg-[#4A36EC]/10",onClick:()=>d({lat:a.latitude,lng:a.longitude}),children:[e.jsx($,{className:"w-4 h-4 mr-2 text-[#4A36EC]"}),"View on Map"]})})]},s)}),n.length===0&&e.jsx(y,{children:e.jsx(p,{colSpan:4,className:"text-center text-gray-500 py-8",children:"No riders added yet"})})]})]})})}function Se(){const[n,d]=x.useState(!1),[a,s]=x.useState([]),[c,o]=x.useState(null),[r,l]=x.useState(null),i=async t=>{try{console.log(t),s([...a,...t]),d(!1),l(null)}catch(u){l("Failed to add riders"),console.error(u)}},h=[{title:"Total Riders",value:a.length,icon:v,description:"Registered riders",trend:"+2.8%",trendUp:!0},{title:"Active Locations",value:a.length,icon:$,description:"Service areas",trend:"+1.9%",trendUp:!0},{title:"License Types",value:new Set(a.map(t=>t.licenseNumber.split("-")[0])).size,icon:te,description:"Different categories",trend:"+3.1%",trendUp:!0},{title:"Service Areas",value:"8",icon:_,description:"Coverage zones",trend:"+2.4%",trendUp:!0}];return e.jsxs("div",{className:"p-8 space-y-8",children:[e.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[e.jsx("a",{href:"/",className:"hover:text-[#4A36EC]",children:"Dashboard"}),e.jsx(C,{className:"w-4 h-4 mx-2"}),e.jsx("a",{href:"/user-management",className:"hover:text-[#4A36EC]",children:"User Management"}),e.jsx(C,{className:"w-4 h-4 mx-2"}),e.jsx("span",{className:"text-[#4A36EC] font-medium",children:"Riders"})]}),e.jsxs(N.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-[#4A36EC]",children:"Delivery Riders"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage delivery riders and their locations"})]}),e.jsxs(b,{onClick:()=>d(!0),className:"bg-[#4A36EC] hover:bg-[#5B4AEE] text-white",children:[e.jsx(F,{className:"w-4 h-4 mr-2"}),"Add Rider"]})]}),e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:h.map((t,u)=>e.jsx(z,{className:"border border-gray-200 hover:border-[#4A36EC] transition-colors",children:e.jsxs(P,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:t.title}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mt-2",children:t.value})]}),e.jsx("div",{className:"bg-[#4A36EC]/10 p-2 rounded-lg",children:e.jsx(t.icon,{className:"w-5 h-5 text-[#4A36EC]"})})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsx("p",{className:"text-xs text-gray-500",children:t.description}),e.jsx("span",{className:`text-xs font-medium ${t.trendUp?"text-green-600":"text-red-600"}`,children:t.trend})]})]})},u))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-6 gap-6",children:[e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"lg:col-span-2 h-[400px] rounded-lg overflow-hidden border",children:e.jsx(xe,{riders:a,selectedLocation:c,onLocationSelect:o})}),e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.3},className:"lg:col-span-4",children:e.jsx(ue,{riders:a,onLocationSelect:o})})]}),r&&e.jsx("div",{className:"text-red-600 text-sm",children:r}),e.jsx(ce,{open:n,onOpenChange:d,onSubmit:i,selectedLocation:c})]})}export{Se as default};
